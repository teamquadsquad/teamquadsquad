{"version":3,"sources":["js/gmaps.js"],"names":["root","factory","exports","module","define","amd","GMaps","window","google","maps","extend_object","obj","new_obj","name","replace_object","replace","undefined","array_map","array","callback","original_callback_params","Array","prototype","slice","call","arguments","array_return","array_length","length","i","map","item","callback_params","splice","apply","push","array_flat","new_array","concat","coordsToLatLngs","coords","useGeoJSON","first_coord","second_coord","LatLng","arrayToLatLng","getElementById","id","context","element","$","document","findAbsolutePosition","curleft","curtop","offsetParent","offsetLeft","offsetTop","global","doc","options","zoom","mapType","self","events_that_hide_context_menu","events_that_doesnt_hide_context_menu","options_to_be_deleted","container_id","el","div","markerClustererFunction","markerClusterer","MapTypeId","toUpperCase","map_center","lat","lng","zoomControl","zoomControlOpt","style","position","zoomControlStyle","zoomControlPosition","panControl","mapTypeControl","scaleControl","streetViewControl","overviewMapControl","map_options","map_base_options","center","mapTypeId","map_controls_options","zoomControlOptions","ZoomControlStyle","ControlPosition","context_menu","controls","overlays","layers","singleLayers","markers","polylines","routes","polygons","infoWindow","overlay_el","registered_events","width","scrollWidth","offsetWidth","height","scrollHeight","offsetHeight","visualRefresh","enableNewStyle","disableDefaultUI","Map","buildContextMenuHTML","control","e","html","hasOwnProperty","option","title","context_menu_element","innerHTML","context_menu_items","getElementsByTagName","context_menu_items_count","context_menu_item","assign_menu_item_action","ev","preventDefault","action","hideContextMenu","event","clearListeners","addDomListenerOnce","left","pixel","x","top","y","display","buildContextMenu","overlay","OverlayView","setMap","draw","projection","getProjection","marker","getPosition","fromLatLngToContainerPixel","setContextMenu","ul","createElement","minWidth","background","listStyle","padding","boxShadow","body","appendChild","addDomListener","relatedTarget","contains","setTimeout","setupListener","object","addListener","rightclick","refresh","trigger","fitZoom","latLngs","markers_length","visible","fitLatLngBounds","total","bounds","LatLngBounds","extend","fitBounds","setCenter","panTo","getElement","zoomIn","value","getZoom","setZoom","zoomOut","native_methods","method","gmaps","scope","method_name","createControl","cursor","disableDefaultStyles","fontFamily","fontSize","classes","className","content","HTMLElement","events","index","addControl","removeControl","controlsForPosition","getAt","removeAt","createMarker","details","fences","outside","base_options","marker_options","Marker","InfoWindow","info_window_events","marker_events","marker_events_with_mouse","me","fromLatLngToPoint","latLng","click","hideInfoWindows","open","checkMarkerGeofence","m","f","addMarker","fire","addMarkers","close","removeMarker","removeMarkers","collection","new_markers","indexOf","getMap","drawOverlay","auto_show","onAdd","borderStyle","borderWidth","zIndex","layer","panes","getPanes","overlayLayer","stop_overlay_events","navigator","userAgent","toLowerCase","all","cancelBubble","returnValue","stopPropagation","overlayMouseTarget","fromLatLngToDivPixel","horizontalOffset","verticalOffset","children","content_height","clientHeight","content_width","clientWidth","verticalAlign","horizontalAlign","show","onRemove","remove","parentNode","removeChild","removeOverlay","removeOverlays","drawPolyline","path","points","latlng","polyline_options","strokeColor","strokeOpacity","strokeWeight","geodesic","clickable","editable","icons","polyline","Polyline","polyline_events","removePolyline","removePolylines","drawCircle","polygon","Circle","polygon_events","drawRectangle","latLngBounds","Rectangle","drawPolygon","paths","Polygon","removePolygon","removePolygons","getFromFusionTables","fusion_tables_options","FusionTablesLayer","loadFromFusionTables","getFromKML","url","kml_options","KmlLayer","loadFromKML","addLayer","layerName","weather","WeatherLayer","clouds","CloudLayer","traffic","TrafficLayer","transit","TransitLayer","bicycling","BicyclingLayer","panoramio","PanoramioLayer","setTag","filter","places","PlacesService","search","nearbySearch","radarSearch","placeSearchRequest","keyword","location","radius","rankBy","types","textSearch","textSearchRequest","query","setOptions","removeLayer","travelMode","unitSystem","getRoutes","TravelMode","BICYCLING","TRANSIT","DRIVING","WALKING","UnitSystem","IMPERIAL","METRIC","avoidHighways","avoidTolls","optimizeWaypoints","waypoints","request_options","origin","test","destination","error","service","DirectionsService","route","result","status","DirectionsStatus","OK","r","removeRoutes","getElevations","locations","samples","ElevationService","getElevationForLocations","pathRequest","getElevationAlongPath","cleanRoute","drawRoute","overview_path","travelRoute","start","step","legs","steps","step_number","end","drawSteppedRoute","Route","step_count","steps_length","MVCArray","getPath","getRoute","back","p","pop","forward","checkGeofence","fence","containsLatLng","outside_callback","pos","toImage","static_map_options","getCenter","geometry","encoding","encodePath","staticMapURL","parameters","data","static_root","styles","address","join","encodeURI","size","sensor","param","loc","icon","color","label","styleRule","featureType","elementType","j","stylers","ruleArg","substring","rule","parseColor","opacity","parseFloat","Math","min","max","toString","parseInt","fillColor","fillcolor","fillOpacity","dpi","devicePixelRatio","addMapType","tileSize","Size","ImageMapType","mapTypes","set","addOverlayMapType","overlayMapTypeIndex","overlayMapTypes","insertAt","removeOverlayMapType","addStyle","styledMapType","StyledMapType","styledMapName","setStyle","setMapTypeId","createPanorama","streetview_options","panorama","setStreetView","streetview_events","StreetViewPanorama","on","event_name","handler","off","custom_events","registered_event","eventName","firing_events","geolocate","complete_callback","always","complete","geolocation","getCurrentPosition","success","not_supported","geocode","geocoder","Geocoder","results","getBounds","getPaths","getLength","inPoly","numPaths","numPoints","vertex1","vertex2","spherical","computeDistanceBetween","getRadius","setFences","addFence","getId","searchElement","TypeError","t","Object","len","n","Number","Infinity","floor","abs","k"],"mappings":"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","file":"gmaps.eb6bac89.js","sourceRoot":"..","sourcesContent":["(function(root, factory) {\n  if(typeof exports === 'object') {\n    module.exports = factory();\n  }\n  else if(typeof define === 'function' && define.amd) {\n    define('GMaps', [], factory);\n  }\n\n  root.GMaps = factory();\n\n}(this, function() {\n\n/*!\n * GMaps.js v0.4.16\n * http://hpneo.github.com/gmaps/\n *\n * Copyright 2014, Gustavo Leon\n * Released under the MIT License.\n */\n\nif (!(typeof window.google === 'object' && window.google.maps)) {\n  throw 'Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true.'\n}\n\nvar extend_object = function(obj, new_obj) {\n  var name;\n\n  if (obj === new_obj) {\n    return obj;\n  }\n\n  for (name in new_obj) {\n    obj[name] = new_obj[name];\n  }\n\n  return obj;\n};\n\nvar replace_object = function(obj, replace) {\n  var name;\n\n  if (obj === replace) {\n    return obj;\n  }\n\n  for (name in replace) {\n    if (obj[name] != undefined) {\n      obj[name] = replace[name];\n    }\n  }\n\n  return obj;\n};\n\nvar array_map = function(array, callback) {\n  var original_callback_params = Array.prototype.slice.call(arguments, 2),\n      array_return = [],\n      array_length = array.length,\n      i;\n\n  if (Array.prototype.map && array.map === Array.prototype.map) {\n    array_return = Array.prototype.map.call(array, function(item) {\n      callback_params = original_callback_params;\n      callback_params.splice(0, 0, item);\n\n      return callback.apply(this, callback_params);\n    });\n  }\n  else {\n    for (i = 0; i < array_length; i++) {\n      callback_params = original_callback_params;\n      callback_params.splice(0, 0, array[i]);\n      array_return.push(callback.apply(this, callback_params));\n    }\n  }\n\n  return array_return;\n};\n\nvar array_flat = function(array) {\n  var new_array = [],\n      i;\n\n  for (i = 0; i < array.length; i++) {\n    new_array = new_array.concat(array[i]);\n  }\n\n  return new_array;\n};\n\nvar coordsToLatLngs = function(coords, useGeoJSON) {\n  var first_coord = coords[0],\n      second_coord = coords[1];\n\n  if (useGeoJSON) {\n    first_coord = coords[1];\n    second_coord = coords[0];\n  }\n\n  return new google.maps.LatLng(first_coord, second_coord);\n};\n\nvar arrayToLatLng = function(coords, useGeoJSON) {\n  var i;\n\n  for (i = 0; i < coords.length; i++) {\n    if (!(coords[i] instanceof google.maps.LatLng)) {\n      if (coords[i].length > 0 && typeof(coords[i][0]) == \"object\") {\n        coords[i] = arrayToLatLng(coords[i], useGeoJSON);\n      }\n      else {\n        coords[i] = coordsToLatLngs(coords[i], useGeoJSON);\n      }\n    }\n  }\n\n  return coords;\n};\n\nvar getElementById = function(id, context) {\n  var element,\n  id = id.replace('#', '');\n\n  if ('jQuery' in this && context) {\n    element = $(\"#\" + id, context)[0];\n  } else {\n    element = document.getElementById(id);\n  };\n\n  return element;\n};\n\nvar findAbsolutePosition = function(obj)  {\n  var curleft = 0,\n      curtop = 0;\n\n  if (obj.offsetParent) {\n    do {\n      curleft += obj.offsetLeft;\n      curtop += obj.offsetTop;\n    } while (obj = obj.offsetParent);\n  }\n\n  return [curleft, curtop];\n};\n\nvar GMaps = (function(global) {\n  \"use strict\";\n\n  var doc = document;\n\n  var GMaps = function(options) {\n    if (!this) return new GMaps(options);\n\n    options.zoom = options.zoom || 15;\n    options.mapType = options.mapType || 'roadmap';\n\n    var self = this,\n        i,\n        events_that_hide_context_menu = ['bounds_changed', 'center_changed', 'click', 'dblclick', 'drag', 'dragend', 'dragstart', 'idle', 'maptypeid_changed', 'projection_changed', 'resize', 'tilesloaded', 'zoom_changed'],\n        events_that_doesnt_hide_context_menu = ['mousemove', 'mouseout', 'mouseover'],\n        options_to_be_deleted = ['el', 'lat', 'lng', 'mapType', 'width', 'height', 'markerClusterer', 'enableNewStyle'],\n        container_id = options.el || options.div,\n        markerClustererFunction = options.markerClusterer,\n        mapType = google.maps.MapTypeId[options.mapType.toUpperCase()],\n        map_center = new google.maps.LatLng(options.lat, options.lng),\n        zoomControl = options.zoomControl || false,\n        zoomControlOpt = options.zoomControlOpt || {\n          style: 'DEFAULT',\n          position: 'TOP_LEFT'\n        },\n        zoomControlStyle = zoomControlOpt.style || 'DEFAULT',\n        zoomControlPosition = zoomControlOpt.position || 'TOP_LEFT',\n        panControl = options.panControl || false,\n        mapTypeControl = options.mapTypeControl || false,\n        scaleControl = options.scaleControl || true,\n        streetViewControl = options.streetViewControl || false,\n        overviewMapControl = overviewMapControl || true,\n        map_options = {},\n        map_base_options = {\n          zoom: this.zoom,\n          center: map_center,\n          mapTypeId: mapType\n        },\n        map_controls_options = {\n          panControl: panControl,\n          zoomControl: zoomControl,\n          zoomControlOptions: {\n            style: google.maps.ZoomControlStyle[zoomControlStyle],\n            position: google.maps.ControlPosition[zoomControlPosition]\n          },\n          mapTypeControl: mapTypeControl,\n          scaleControl: scaleControl,\n          streetViewControl: streetViewControl,\n          overviewMapControl: overviewMapControl\n        };\n\n    if (typeof(options.el) === 'string' || typeof(options.div) === 'string') {\n      this.el = getElementById(container_id, options.context);\n    } else {\n      this.el = container_id;\n    }\n\n    if (typeof(this.el) === 'undefined' || this.el === null) {\n      throw 'No element defined.';\n    }\n\n    window.context_menu = window.context_menu || {};\n    window.context_menu[self.el.id] = {};\n\n    this.controls = [];\n    this.overlays = [];\n    this.layers = []; // array with kml/georss and fusiontables layers, can be as many\n    this.singleLayers = {}; // object with the other layers, only one per layer\n    this.markers = [];\n    this.polylines = [];\n    this.routes = [];\n    this.polygons = [];\n    this.infoWindow = null;\n    this.overlay_el = null;\n    this.zoom = options.zoom;\n    this.registered_events = {};\n\n    this.el.style.width = options.width || this.el.scrollWidth || this.el.offsetWidth;\n    this.el.style.height = options.height || this.el.scrollHeight || this.el.offsetHeight;\n\n    google.maps.visualRefresh = options.enableNewStyle;\n\n    for (i = 0; i < options_to_be_deleted.length; i++) {\n      delete options[options_to_be_deleted[i]];\n    }\n\n    if(options.disableDefaultUI != true) {\n      map_base_options = extend_object(map_base_options, map_controls_options);\n    }\n\n    map_options = extend_object(map_base_options, options);\n\n    for (i = 0; i < events_that_hide_context_menu.length; i++) {\n      delete map_options[events_that_hide_context_menu[i]];\n    }\n\n    for (i = 0; i < events_that_doesnt_hide_context_menu.length; i++) {\n      delete map_options[events_that_doesnt_hide_context_menu[i]];\n    }\n\n    this.map = new google.maps.Map(this.el, map_options);\n\n    if (markerClustererFunction) {\n      this.markerClusterer = markerClustererFunction.apply(this, [this.map]);\n    }\n\n    var buildContextMenuHTML = function(control, e) {\n      var html = '',\n          options = window.context_menu[self.el.id][control];\n\n      for (var i in options){\n        if (options.hasOwnProperty(i)) {\n          var option = options[i];\n\n          html += '<li><a id=\"' + control + '_' + i + '\" href=\"#\">' + option.title + '</a></li>';\n        }\n      }\n\n      if (!getElementById('gmaps_context_menu')) return;\n\n      var context_menu_element = getElementById('gmaps_context_menu');\n      \n      context_menu_element.innerHTML = html;\n\n      var context_menu_items = context_menu_element.getElementsByTagName('a'),\n          context_menu_items_count = context_menu_items.length,\n          i;\n\n      for (i = 0; i < context_menu_items_count; i++) {\n        var context_menu_item = context_menu_items[i];\n\n        var assign_menu_item_action = function(ev){\n          ev.preventDefault();\n\n          options[this.id.replace(control + '_', '')].action.apply(self, [e]);\n          self.hideContextMenu();\n        };\n\n        google.maps.event.clearListeners(context_menu_item, 'click');\n        google.maps.event.addDomListenerOnce(context_menu_item, 'click', assign_menu_item_action, false);\n      }\n\n      var position = findAbsolutePosition.apply(this, [self.el]),\n          left = position[0] + e.pixel.x - 15,\n          top = position[1] + e.pixel.y- 15;\n\n      context_menu_element.style.left = left + \"px\";\n      context_menu_element.style.top = top + \"px\";\n\n      context_menu_element.style.display = 'block';\n    };\n\n    this.buildContextMenu = function(control, e) {\n      if (control === 'marker') {\n        e.pixel = {};\n\n        var overlay = new google.maps.OverlayView();\n        overlay.setMap(self.map);\n        \n        overlay.draw = function() {\n          var projection = overlay.getProjection(),\n              position = e.marker.getPosition();\n          \n          e.pixel = projection.fromLatLngToContainerPixel(position);\n\n          buildContextMenuHTML(control, e);\n        };\n      }\n      else {\n        buildContextMenuHTML(control, e);\n      }\n    };\n\n    this.setContextMenu = function(options) {\n      window.context_menu[self.el.id][options.control] = {};\n\n      var i,\n          ul = doc.createElement('ul');\n\n      for (i in options.options) {\n        if (options.options.hasOwnProperty(i)) {\n          var option = options.options[i];\n\n          window.context_menu[self.el.id][options.control][option.name] = {\n            title: option.title,\n            action: option.action\n          };\n        }\n      }\n\n      ul.id = 'gmaps_context_menu';\n      ul.style.display = 'none';\n      ul.style.position = 'absolute';\n      ul.style.minWidth = '100px';\n      ul.style.background = 'white';\n      ul.style.listStyle = 'none';\n      ul.style.padding = '8px';\n      ul.style.boxShadow = '2px 2px 6px #ccc';\n\n      doc.body.appendChild(ul);\n\n      var context_menu_element = getElementById('gmaps_context_menu')\n\n      google.maps.event.addDomListener(context_menu_element, 'mouseout', function(ev) {\n        if (!ev.relatedTarget || !this.contains(ev.relatedTarget)) {\n          window.setTimeout(function(){\n            context_menu_element.style.display = 'none';\n          }, 400);\n        }\n      }, false);\n    };\n\n    this.hideContextMenu = function() {\n      var context_menu_element = getElementById('gmaps_context_menu');\n\n      if (context_menu_element) {\n        context_menu_element.style.display = 'none';\n      }\n    };\n\n    var setupListener = function(object, name) {\n      google.maps.event.addListener(object, name, function(e){\n        if (e == undefined) {\n          e = this;\n        }\n\n        options[name].apply(this, [e]);\n\n        self.hideContextMenu();\n      });\n    };\n\n    //google.maps.event.addListener(this.map, 'idle', this.hideContextMenu);\n    google.maps.event.addListener(this.map, 'zoom_changed', this.hideContextMenu);\n\n    for (var ev = 0; ev < events_that_hide_context_menu.length; ev++) {\n      var name = events_that_hide_context_menu[ev];\n\n      if (name in options) {\n        setupListener(this.map, name);\n      }\n    }\n\n    for (var ev = 0; ev < events_that_doesnt_hide_context_menu.length; ev++) {\n      var name = events_that_doesnt_hide_context_menu[ev];\n\n      if (name in options) {\n        setupListener(this.map, name);\n      }\n    }\n\n    google.maps.event.addListener(this.map, 'rightclick', function(e) {\n      if (options.rightclick) {\n        options.rightclick.apply(this, [e]);\n      }\n\n      if(window.context_menu[self.el.id]['map'] != undefined) {\n        self.buildContextMenu('map', e);\n      }\n    });\n\n    this.refresh = function() {\n      google.maps.event.trigger(this.map, 'resize');\n    };\n\n    this.fitZoom = function() {\n      var latLngs = [],\n          markers_length = this.markers.length,\n          i;\n\n      for (i = 0; i < markers_length; i++) {\n        if(typeof(this.markers[i].visible) === 'boolean' && this.markers[i].visible) {\n          latLngs.push(this.markers[i].getPosition());\n        }\n      }\n\n      this.fitLatLngBounds(latLngs);\n    };\n\n    this.fitLatLngBounds = function(latLngs) {\n      var total = latLngs.length;\n      var bounds = new google.maps.LatLngBounds();\n\n      for(var i=0; i < total; i++) {\n        bounds.extend(latLngs[i]);\n      }\n\n      this.map.fitBounds(bounds);\n    };\n\n    this.setCenter = function(lat, lng, callback) {\n      this.map.panTo(new google.maps.LatLng(lat, lng));\n\n      if (callback) {\n        callback();\n      }\n    };\n\n    this.getElement = function() {\n      return this.el;\n    };\n\n    this.zoomIn = function(value) {\n      value = value || 1;\n\n      this.zoom = this.map.getZoom() + value;\n      this.map.setZoom(this.zoom);\n    };\n\n    this.zoomOut = function(value) {\n      value = value || 1;\n\n      this.zoom = this.map.getZoom() - value;\n      this.map.setZoom(this.zoom);\n    };\n\n    var native_methods = [],\n        method;\n\n    for (method in this.map) {\n      if (typeof(this.map[method]) == 'function' && !this[method]) {\n        native_methods.push(method);\n      }\n    }\n\n    for (i=0; i < native_methods.length; i++) {\n      (function(gmaps, scope, method_name) {\n        gmaps[method_name] = function(){\n          return scope[method_name].apply(scope, arguments);\n        };\n      })(this, this.map, native_methods[i]);\n    }\n  };\n\n  return GMaps;\n})(this);\n\nGMaps.prototype.createControl = function(options) {\n  var control = document.createElement('div');\n\n  control.style.cursor = 'pointer';\n  \n  if (options.disableDefaultStyles !== true) {\n    control.style.fontFamily = 'Roboto, Arial, sans-serif';\n    control.style.fontSize = '11px';\n    control.style.boxShadow = 'rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px';\n  }\n\n  for (var option in options.style) {\n    control.style[option] = options.style[option];\n  }\n\n  if (options.id) {\n    control.id = options.id;\n  }\n\n  if (options.classes) {\n    control.className = options.classes;\n  }\n\n  if (options.content) {\n    if (typeof options.content === 'string') {\n      control.innerHTML = options.content;\n    }\n    else if (options.content instanceof HTMLElement) {\n      control.appendChild(options.content);\n    }\n  }\n\n  if (options.position) {\n    control.position = google.maps.ControlPosition[options.position.toUpperCase()];\n  }\n\n  for (var ev in options.events) {\n    (function(object, name) {\n      google.maps.event.addDomListener(object, name, function(){\n        options.events[name].apply(this, [this]);\n      });\n    })(control, ev);\n  }\n\n  control.index = 1;\n\n  return control;\n};\n\nGMaps.prototype.addControl = function(options) {\n  var control = this.createControl(options);\n  this.controls.push(control);\n  this.map.controls[control.position].push(control);\n\n  return control;\n};\n\nGMaps.prototype.removeControl = function(control) {\n  var position = null;\n\n  for (var i = 0; i < this.controls.length; i++) {\n    if (this.controls[i] == control) {\n      position = this.controls[i].position;\n      this.controls.splice(i, 1);\n    }\n  }\n\n  if (position) {\n    for (i = 0; i < this.map.controls.length; i++) {\n      var controlsForPosition = this.map.controls[control.position]\n      if (controlsForPosition.getAt(i) == control) {\n        controlsForPosition.removeAt(i);\n        break;\n      }\n    }\n  }\n\n  return control;\n};\n\nGMaps.prototype.createMarker = function(options) {\n  if (options.lat == undefined && options.lng == undefined && options.position == undefined) {\n    throw 'No latitude or longitude defined.';\n  }\n\n  var self = this,\n      details = options.details,\n      fences = options.fences,\n      outside = options.outside,\n      base_options = {\n        position: new google.maps.LatLng(options.lat, options.lng),\n        map: null\n      },\n      marker_options = extend_object(base_options, options);\n\n  delete marker_options.lat;\n  delete marker_options.lng;\n  delete marker_options.fences;\n  delete marker_options.outside;\n\n  var marker = new google.maps.Marker(marker_options);\n\n  marker.fences = fences;\n\n  if (options.infoWindow) {\n    marker.infoWindow = new google.maps.InfoWindow(options.infoWindow);\n\n    var info_window_events = ['closeclick', 'content_changed', 'domready', 'position_changed', 'zindex_changed'];\n\n    for (var ev = 0; ev < info_window_events.length; ev++) {\n      (function(object, name) {\n        if (options.infoWindow[name]) {\n          google.maps.event.addListener(object, name, function(e){\n            options.infoWindow[name].apply(this, [e]);\n          });\n        }\n      })(marker.infoWindow, info_window_events[ev]);\n    }\n  }\n\n  var marker_events = ['animation_changed', 'clickable_changed', 'cursor_changed', 'draggable_changed', 'flat_changed', 'icon_changed', 'position_changed', 'shadow_changed', 'shape_changed', 'title_changed', 'visible_changed', 'zindex_changed'];\n\n  var marker_events_with_mouse = ['dblclick', 'drag', 'dragend', 'dragstart', 'mousedown', 'mouseout', 'mouseover', 'mouseup'];\n\n  for (var ev = 0; ev < marker_events.length; ev++) {\n    (function(object, name) {\n      if (options[name]) {\n        google.maps.event.addListener(object, name, function(){\n          options[name].apply(this, [this]);\n        });\n      }\n    })(marker, marker_events[ev]);\n  }\n\n  for (var ev = 0; ev < marker_events_with_mouse.length; ev++) {\n    (function(map, object, name) {\n      if (options[name]) {\n        google.maps.event.addListener(object, name, function(me){\n          if(!me.pixel){\n            me.pixel = map.getProjection().fromLatLngToPoint(me.latLng)\n          }\n          \n          options[name].apply(this, [me]);\n        });\n      }\n    })(this.map, marker, marker_events_with_mouse[ev]);\n  }\n\n  google.maps.event.addListener(marker, 'click', function() {\n    this.details = details;\n\n    if (options.click) {\n      options.click.apply(this, [this]);\n    }\n\n    if (marker.infoWindow) {\n      self.hideInfoWindows();\n      marker.infoWindow.open(self.map, marker);\n    }\n  });\n\n  google.maps.event.addListener(marker, 'rightclick', function(e) {\n    e.marker = this;\n\n    if (options.rightclick) {\n      options.rightclick.apply(this, [e]);\n    }\n\n    if (window.context_menu[self.el.id]['marker'] != undefined) {\n      self.buildContextMenu('marker', e);\n    }\n  });\n\n  if (marker.fences) {\n    google.maps.event.addListener(marker, 'dragend', function() {\n      self.checkMarkerGeofence(marker, function(m, f) {\n        outside(m, f);\n      });\n    });\n  }\n\n  return marker;\n};\n\nGMaps.prototype.addMarker = function(options) {\n  var marker;\n  if(options.hasOwnProperty('gm_accessors_')) {\n    // Native google.maps.Marker object\n    marker = options;\n  }\n  else {\n    if ((options.hasOwnProperty('lat') && options.hasOwnProperty('lng')) || options.position) {\n      marker = this.createMarker(options);\n    }\n    else {\n      throw 'No latitude or longitude defined.';\n    }\n  }\n\n  marker.setMap(this.map);\n\n  if(this.markerClusterer) {\n    this.markerClusterer.addMarker(marker);\n  }\n\n  this.markers.push(marker);\n\n  GMaps.fire('marker_added', marker, this);\n\n  return marker;\n};\n\nGMaps.prototype.addMarkers = function(array) {\n  for (var i = 0, marker; marker=array[i]; i++) {\n    this.addMarker(marker);\n  }\n\n  return this.markers;\n};\n\nGMaps.prototype.hideInfoWindows = function() {\n  for (var i = 0, marker; marker = this.markers[i]; i++){\n    if (marker.infoWindow) {\n      marker.infoWindow.close();\n    }\n  }\n};\n\nGMaps.prototype.removeMarker = function(marker) {\n  for (var i = 0; i < this.markers.length; i++) {\n    if (this.markers[i] === marker) {\n      this.markers[i].setMap(null);\n      this.markers.splice(i, 1);\n\n      if(this.markerClusterer) {\n        this.markerClusterer.removeMarker(marker);\n      }\n\n      GMaps.fire('marker_removed', marker, this);\n\n      break;\n    }\n  }\n\n  return marker;\n};\n\nGMaps.prototype.removeMarkers = function (collection) {\n  var new_markers = [];\n\n  if (typeof collection == 'undefined') {\n    for (var i = 0; i < this.markers.length; i++) {\n      var marker = this.markers[i];\n      marker.setMap(null);\n\n      if(this.markerClusterer) {\n        this.markerClusterer.removeMarker(marker);\n      }\n\n      GMaps.fire('marker_removed', marker, this);\n    }\n    \n    this.markers = new_markers;\n  }\n  else {\n    for (var i = 0; i < collection.length; i++) {\n      var index = this.markers.indexOf(collection[i]);\n\n      if (index > -1) {\n        var marker = this.markers[index];\n        marker.setMap(null);\n\n        if(this.markerClusterer) {\n          this.markerClusterer.removeMarker(marker);\n        }\n\n        GMaps.fire('marker_removed', marker, this);\n      }\n    }\n\n    for (var i = 0; i < this.markers.length; i++) {\n      var marker = this.markers[i];\n      if (marker.getMap() != null) {\n        new_markers.push(marker);\n      }\n    }\n\n    this.markers = new_markers;\n  }\n};\n\nGMaps.prototype.drawOverlay = function(options) {\n  var overlay = new google.maps.OverlayView(),\n      auto_show = true;\n\n  overlay.setMap(this.map);\n\n  if (options.auto_show != null) {\n    auto_show = options.auto_show;\n  }\n\n  overlay.onAdd = function() {\n    var el = document.createElement('div');\n\n    el.style.borderStyle = \"none\";\n    el.style.borderWidth = \"0px\";\n    el.style.position = \"absolute\";\n    el.style.zIndex = 100;\n    el.innerHTML = options.content;\n\n    overlay.el = el;\n\n    if (!options.layer) {\n      options.layer = 'overlayLayer';\n    }\n    \n    var panes = this.getPanes(),\n        overlayLayer = panes[options.layer],\n        stop_overlay_events = ['contextmenu', 'DOMMouseScroll', 'dblclick', 'mousedown'];\n\n    overlayLayer.appendChild(el);\n\n    for (var ev = 0; ev < stop_overlay_events.length; ev++) {\n      (function(object, name) {\n        google.maps.event.addDomListener(object, name, function(e){\n          if (navigator.userAgent.toLowerCase().indexOf('msie') != -1 && document.all) {\n            e.cancelBubble = true;\n            e.returnValue = false;\n          }\n          else {\n            e.stopPropagation();\n          }\n        });\n      })(el, stop_overlay_events[ev]);\n    }\n\n    if (options.click) {\n      panes.overlayMouseTarget.appendChild(overlay.el);\n      google.maps.event.addDomListener(overlay.el, 'click', function() {\n        options.click.apply(overlay, [overlay]);\n      });\n    }\n\n    google.maps.event.trigger(this, 'ready');\n  };\n\n  overlay.draw = function() {\n    var projection = this.getProjection(),\n        pixel = projection.fromLatLngToDivPixel(new google.maps.LatLng(options.lat, options.lng));\n\n    options.horizontalOffset = options.horizontalOffset || 0;\n    options.verticalOffset = options.verticalOffset || 0;\n\n    var el = overlay.el,\n        content = el.children[0],\n        content_height = content.clientHeight,\n        content_width = content.clientWidth;\n\n    switch (options.verticalAlign) {\n      case 'top':\n        el.style.top = (pixel.y - content_height + options.verticalOffset) + 'px';\n        break;\n      default:\n      case 'middle':\n        el.style.top = (pixel.y - (content_height / 2) + options.verticalOffset) + 'px';\n        break;\n      case 'bottom':\n        el.style.top = (pixel.y + options.verticalOffset) + 'px';\n        break;\n    }\n\n    switch (options.horizontalAlign) {\n      case 'left':\n        el.style.left = (pixel.x - content_width + options.horizontalOffset) + 'px';\n        break;\n      default:\n      case 'center':\n        el.style.left = (pixel.x - (content_width / 2) + options.horizontalOffset) + 'px';\n        break;\n      case 'right':\n        el.style.left = (pixel.x + options.horizontalOffset) + 'px';\n        break;\n    }\n\n    el.style.display = auto_show ? 'block' : 'none';\n\n    if (!auto_show) {\n      options.show.apply(this, [el]);\n    }\n  };\n\n  overlay.onRemove = function() {\n    var el = overlay.el;\n\n    if (options.remove) {\n      options.remove.apply(this, [el]);\n    }\n    else {\n      overlay.el.parentNode.removeChild(overlay.el);\n      overlay.el = null;\n    }\n  };\n\n  this.overlays.push(overlay);\n  return overlay;\n};\n\nGMaps.prototype.removeOverlay = function(overlay) {\n  for (var i = 0; i < this.overlays.length; i++) {\n    if (this.overlays[i] === overlay) {\n      this.overlays[i].setMap(null);\n      this.overlays.splice(i, 1);\n\n      break;\n    }\n  }\n};\n\nGMaps.prototype.removeOverlays = function() {\n  for (var i = 0, item; item = this.overlays[i]; i++) {\n    item.setMap(null);\n  }\n\n  this.overlays = [];\n};\n\nGMaps.prototype.drawPolyline = function(options) {\n  var path = [],\n      points = options.path;\n\n  if (points.length) {\n    if (points[0][0] === undefined) {\n      path = points;\n    }\n    else {\n      for (var i=0, latlng; latlng=points[i]; i++) {\n        path.push(new google.maps.LatLng(latlng[0], latlng[1]));\n      }\n    }\n  }\n\n  var polyline_options = {\n    map: this.map,\n    path: path,\n    strokeColor: options.strokeColor,\n    strokeOpacity: options.strokeOpacity,\n    strokeWeight: options.strokeWeight,\n    geodesic: options.geodesic,\n    clickable: true,\n    editable: false,\n    visible: true\n  };\n\n  if (options.hasOwnProperty(\"clickable\")) {\n    polyline_options.clickable = options.clickable;\n  }\n\n  if (options.hasOwnProperty(\"editable\")) {\n    polyline_options.editable = options.editable;\n  }\n\n  if (options.hasOwnProperty(\"icons\")) {\n    polyline_options.icons = options.icons;\n  }\n\n  if (options.hasOwnProperty(\"zIndex\")) {\n    polyline_options.zIndex = options.zIndex;\n  }\n\n  var polyline = new google.maps.Polyline(polyline_options);\n\n  var polyline_events = ['click', 'dblclick', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'rightclick'];\n\n  for (var ev = 0; ev < polyline_events.length; ev++) {\n    (function(object, name) {\n      if (options[name]) {\n        google.maps.event.addListener(object, name, function(e){\n          options[name].apply(this, [e]);\n        });\n      }\n    })(polyline, polyline_events[ev]);\n  }\n\n  this.polylines.push(polyline);\n\n  GMaps.fire('polyline_added', polyline, this);\n\n  return polyline;\n};\n\nGMaps.prototype.removePolyline = function(polyline) {\n  for (var i = 0; i < this.polylines.length; i++) {\n    if (this.polylines[i] === polyline) {\n      this.polylines[i].setMap(null);\n      this.polylines.splice(i, 1);\n\n      GMaps.fire('polyline_removed', polyline, this);\n\n      break;\n    }\n  }\n};\n\nGMaps.prototype.removePolylines = function() {\n  for (var i = 0, item; item = this.polylines[i]; i++) {\n    item.setMap(null);\n  }\n\n  this.polylines = [];\n};\n\nGMaps.prototype.drawCircle = function(options) {\n  options =  extend_object({\n    map: this.map,\n    center: new google.maps.LatLng(options.lat, options.lng)\n  }, options);\n\n  delete options.lat;\n  delete options.lng;\n\n  var polygon = new google.maps.Circle(options),\n      polygon_events = ['click', 'dblclick', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'rightclick'];\n\n  for (var ev = 0; ev < polygon_events.length; ev++) {\n    (function(object, name) {\n      if (options[name]) {\n        google.maps.event.addListener(object, name, function(e){\n          options[name].apply(this, [e]);\n        });\n      }\n    })(polygon, polygon_events[ev]);\n  }\n\n  this.polygons.push(polygon);\n\n  return polygon;\n};\n\nGMaps.prototype.drawRectangle = function(options) {\n  options = extend_object({\n    map: this.map\n  }, options);\n\n  var latLngBounds = new google.maps.LatLngBounds(\n    new google.maps.LatLng(options.bounds[0][0], options.bounds[0][1]),\n    new google.maps.LatLng(options.bounds[1][0], options.bounds[1][1])\n  );\n\n  options.bounds = latLngBounds;\n\n  var polygon = new google.maps.Rectangle(options),\n      polygon_events = ['click', 'dblclick', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'rightclick'];\n\n  for (var ev = 0; ev < polygon_events.length; ev++) {\n    (function(object, name) {\n      if (options[name]) {\n        google.maps.event.addListener(object, name, function(e){\n          options[name].apply(this, [e]);\n        });\n      }\n    })(polygon, polygon_events[ev]);\n  }\n\n  this.polygons.push(polygon);\n\n  return polygon;\n};\n\nGMaps.prototype.drawPolygon = function(options) {\n  var useGeoJSON = false;\n\n  if(options.hasOwnProperty(\"useGeoJSON\")) {\n    useGeoJSON = options.useGeoJSON;\n  }\n\n  delete options.useGeoJSON;\n\n  options = extend_object({\n    map: this.map\n  }, options);\n\n  if (useGeoJSON == false) {\n    options.paths = [options.paths.slice(0)];\n  }\n\n  if (options.paths.length > 0) {\n    if (options.paths[0].length > 0) {\n      options.paths = array_flat(array_map(options.paths, arrayToLatLng, useGeoJSON));\n    }\n  }\n\n  var polygon = new google.maps.Polygon(options),\n      polygon_events = ['click', 'dblclick', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'rightclick'];\n\n  for (var ev = 0; ev < polygon_events.length; ev++) {\n    (function(object, name) {\n      if (options[name]) {\n        google.maps.event.addListener(object, name, function(e){\n          options[name].apply(this, [e]);\n        });\n      }\n    })(polygon, polygon_events[ev]);\n  }\n\n  this.polygons.push(polygon);\n\n  GMaps.fire('polygon_added', polygon, this);\n\n  return polygon;\n};\n\nGMaps.prototype.removePolygon = function(polygon) {\n  for (var i = 0; i < this.polygons.length; i++) {\n    if (this.polygons[i] === polygon) {\n      this.polygons[i].setMap(null);\n      this.polygons.splice(i, 1);\n\n      GMaps.fire('polygon_removed', polygon, this);\n\n      break;\n    }\n  }\n};\n\nGMaps.prototype.removePolygons = function() {\n  for (var i = 0, item; item = this.polygons[i]; i++) {\n    item.setMap(null);\n  }\n\n  this.polygons = [];\n};\n\nGMaps.prototype.getFromFusionTables = function(options) {\n  var events = options.events;\n\n  delete options.events;\n\n  var fusion_tables_options = options,\n      layer = new google.maps.FusionTablesLayer(fusion_tables_options);\n\n  for (var ev in events) {\n    (function(object, name) {\n      google.maps.event.addListener(object, name, function(e) {\n        events[name].apply(this, [e]);\n      });\n    })(layer, ev);\n  }\n\n  this.layers.push(layer);\n\n  return layer;\n};\n\nGMaps.prototype.loadFromFusionTables = function(options) {\n  var layer = this.getFromFusionTables(options);\n  layer.setMap(this.map);\n\n  return layer;\n};\n\nGMaps.prototype.getFromKML = function(options) {\n  var url = options.url,\n      events = options.events;\n\n  delete options.url;\n  delete options.events;\n\n  var kml_options = options,\n      layer = new google.maps.KmlLayer(url, kml_options);\n\n  for (var ev in events) {\n    (function(object, name) {\n      google.maps.event.addListener(object, name, function(e) {\n        events[name].apply(this, [e]);\n      });\n    })(layer, ev);\n  }\n\n  this.layers.push(layer);\n\n  return layer;\n};\n\nGMaps.prototype.loadFromKML = function(options) {\n  var layer = this.getFromKML(options);\n  layer.setMap(this.map);\n\n  return layer;\n};\n\nGMaps.prototype.addLayer = function(layerName, options) {\n  //var default_layers = ['weather', 'clouds', 'traffic', 'transit', 'bicycling', 'panoramio', 'places'];\n  options = options || {};\n  var layer;\n\n  switch(layerName) {\n    case 'weather': this.singleLayers.weather = layer = new google.maps.weather.WeatherLayer();\n      break;\n    case 'clouds': this.singleLayers.clouds = layer = new google.maps.weather.CloudLayer();\n      break;\n    case 'traffic': this.singleLayers.traffic = layer = new google.maps.TrafficLayer();\n      break;\n    case 'transit': this.singleLayers.transit = layer = new google.maps.TransitLayer();\n      break;\n    case 'bicycling': this.singleLayers.bicycling = layer = new google.maps.BicyclingLayer();\n      break;\n    case 'panoramio':\n        this.singleLayers.panoramio = layer = new google.maps.panoramio.PanoramioLayer();\n        layer.setTag(options.filter);\n        delete options.filter;\n\n        //click event\n        if (options.click) {\n          google.maps.event.addListener(layer, 'click', function(event) {\n            options.click(event);\n            delete options.click;\n          });\n        }\n      break;\n      case 'places':\n        this.singleLayers.places = layer = new google.maps.places.PlacesService(this.map);\n\n        //search, nearbySearch, radarSearch callback, Both are the same\n        if (options.search || options.nearbySearch || options.radarSearch) {\n          var placeSearchRequest  = {\n            bounds : options.bounds || null,\n            keyword : options.keyword || null,\n            location : options.location || null,\n            name : options.name || null,\n            radius : options.radius || null,\n            rankBy : options.rankBy || null,\n            types : options.types || null\n          };\n\n          if (options.radarSearch) {\n            layer.radarSearch(placeSearchRequest, options.radarSearch);\n          }\n\n          if (options.search) {\n            layer.search(placeSearchRequest, options.search);\n          }\n\n          if (options.nearbySearch) {\n            layer.nearbySearch(placeSearchRequest, options.nearbySearch);\n          }\n        }\n\n        //textSearch callback\n        if (options.textSearch) {\n          var textSearchRequest  = {\n            bounds : options.bounds || null,\n            location : options.location || null,\n            query : options.query || null,\n            radius : options.radius || null\n          };\n\n          layer.textSearch(textSearchRequest, options.textSearch);\n        }\n      break;\n  }\n\n  if (layer !== undefined) {\n    if (typeof layer.setOptions == 'function') {\n      layer.setOptions(options);\n    }\n    if (typeof layer.setMap == 'function') {\n      layer.setMap(this.map);\n    }\n\n    return layer;\n  }\n};\n\nGMaps.prototype.removeLayer = function(layer) {\n  if (typeof(layer) == \"string\" && this.singleLayers[layer] !== undefined) {\n     this.singleLayers[layer].setMap(null);\n\n     delete this.singleLayers[layer];\n  }\n  else {\n    for (var i = 0; i < this.layers.length; i++) {\n      if (this.layers[i] === layer) {\n        this.layers[i].setMap(null);\n        this.layers.splice(i, 1);\n\n        break;\n      }\n    }\n  }\n};\n\nvar travelMode, unitSystem;\n\nGMaps.prototype.getRoutes = function(options) {\n  switch (options.travelMode) {\n    case 'bicycling':\n      travelMode = google.maps.TravelMode.BICYCLING;\n      break;\n    case 'transit':\n      travelMode = google.maps.TravelMode.TRANSIT;\n      break;\n    case 'driving':\n      travelMode = google.maps.TravelMode.DRIVING;\n      break;\n    default:\n      travelMode = google.maps.TravelMode.WALKING;\n      break;\n  }\n\n  if (options.unitSystem === 'imperial') {\n    unitSystem = google.maps.UnitSystem.IMPERIAL;\n  }\n  else {\n    unitSystem = google.maps.UnitSystem.METRIC;\n  }\n\n  var base_options = {\n        avoidHighways: false,\n        avoidTolls: false,\n        optimizeWaypoints: false,\n        waypoints: []\n      },\n      request_options =  extend_object(base_options, options);\n\n  request_options.origin = /string/.test(typeof options.origin) ? options.origin : new google.maps.LatLng(options.origin[0], options.origin[1]);\n  request_options.destination = /string/.test(typeof options.destination) ? options.destination : new google.maps.LatLng(options.destination[0], options.destination[1]);\n  request_options.travelMode = travelMode;\n  request_options.unitSystem = unitSystem;\n\n  delete request_options.callback;\n  delete request_options.error;\n\n  var self = this,\n      service = new google.maps.DirectionsService();\n\n  service.route(request_options, function(result, status) {\n    if (status === google.maps.DirectionsStatus.OK) {\n      for (var r in result.routes) {\n        if (result.routes.hasOwnProperty(r)) {\n          self.routes.push(result.routes[r]);\n        }\n      }\n\n      if (options.callback) {\n        options.callback(self.routes);\n      }\n    }\n    else {\n      if (options.error) {\n        options.error(result, status);\n      }\n    }\n  });\n};\n\nGMaps.prototype.removeRoutes = function() {\n  this.routes = [];\n};\n\nGMaps.prototype.getElevations = function(options) {\n  options = extend_object({\n    locations: [],\n    path : false,\n    samples : 256\n  }, options);\n\n  if (options.locations.length > 0) {\n    if (options.locations[0].length > 0) {\n      options.locations = array_flat(array_map([options.locations], arrayToLatLng,  false));\n    }\n  }\n\n  var callback = options.callback;\n  delete options.callback;\n\n  var service = new google.maps.ElevationService();\n\n  //location request\n  if (!options.path) {\n    delete options.path;\n    delete options.samples;\n\n    service.getElevationForLocations(options, function(result, status) {\n      if (callback && typeof(callback) === \"function\") {\n        callback(result, status);\n      }\n    });\n  //path request\n  } else {\n    var pathRequest = {\n      path : options.locations,\n      samples : options.samples\n    };\n\n    service.getElevationAlongPath(pathRequest, function(result, status) {\n     if (callback && typeof(callback) === \"function\") {\n        callback(result, status);\n      }\n    });\n  }\n};\n\nGMaps.prototype.cleanRoute = GMaps.prototype.removePolylines;\n\nGMaps.prototype.drawRoute = function(options) {\n  var self = this;\n\n  this.getRoutes({\n    origin: options.origin,\n    destination: options.destination,\n    travelMode: options.travelMode,\n    waypoints: options.waypoints,\n    unitSystem: options.unitSystem,\n    error: options.error,\n    callback: function(e) {\n      if (e.length > 0) {\n        self.drawPolyline({\n          path: e[e.length - 1].overview_path,\n          strokeColor: options.strokeColor,\n          strokeOpacity: options.strokeOpacity,\n          strokeWeight: options.strokeWeight\n        });\n        \n        if (options.callback) {\n          options.callback(e[e.length - 1]);\n        }\n      }\n    }\n  });\n};\n\nGMaps.prototype.travelRoute = function(options) {\n  if (options.origin && options.destination) {\n    this.getRoutes({\n      origin: options.origin,\n      destination: options.destination,\n      travelMode: options.travelMode,\n      waypoints : options.waypoints,\n      unitSystem: options.unitSystem,\n      error: options.error,\n      callback: function(e) {\n        //start callback\n        if (e.length > 0 && options.start) {\n          options.start(e[e.length - 1]);\n        }\n\n        //step callback\n        if (e.length > 0 && options.step) {\n          var route = e[e.length - 1];\n          if (route.legs.length > 0) {\n            var steps = route.legs[0].steps;\n            for (var i=0, step; step=steps[i]; i++) {\n              step.step_number = i;\n              options.step(step, (route.legs[0].steps.length - 1));\n            }\n          }\n        }\n\n        //end callback\n        if (e.length > 0 && options.end) {\n           options.end(e[e.length - 1]);\n        }\n      }\n    });\n  }\n  else if (options.route) {\n    if (options.route.legs.length > 0) {\n      var steps = options.route.legs[0].steps;\n      for (var i=0, step; step=steps[i]; i++) {\n        step.step_number = i;\n        options.step(step);\n      }\n    }\n  }\n};\n\nGMaps.prototype.drawSteppedRoute = function(options) {\n  var self = this;\n  \n  if (options.origin && options.destination) {\n    this.getRoutes({\n      origin: options.origin,\n      destination: options.destination,\n      travelMode: options.travelMode,\n      waypoints : options.waypoints,\n      error: options.error,\n      callback: function(e) {\n        //start callback\n        if (e.length > 0 && options.start) {\n          options.start(e[e.length - 1]);\n        }\n\n        //step callback\n        if (e.length > 0 && options.step) {\n          var route = e[e.length - 1];\n          if (route.legs.length > 0) {\n            var steps = route.legs[0].steps;\n            for (var i=0, step; step=steps[i]; i++) {\n              step.step_number = i;\n              self.drawPolyline({\n                path: step.path,\n                strokeColor: options.strokeColor,\n                strokeOpacity: options.strokeOpacity,\n                strokeWeight: options.strokeWeight\n              });\n              options.step(step, (route.legs[0].steps.length - 1));\n            }\n          }\n        }\n\n        //end callback\n        if (e.length > 0 && options.end) {\n           options.end(e[e.length - 1]);\n        }\n      }\n    });\n  }\n  else if (options.route) {\n    if (options.route.legs.length > 0) {\n      var steps = options.route.legs[0].steps;\n      for (var i=0, step; step=steps[i]; i++) {\n        step.step_number = i;\n        self.drawPolyline({\n          path: step.path,\n          strokeColor: options.strokeColor,\n          strokeOpacity: options.strokeOpacity,\n          strokeWeight: options.strokeWeight\n        });\n        options.step(step);\n      }\n    }\n  }\n};\n\nGMaps.Route = function(options) {\n  this.origin = options.origin;\n  this.destination = options.destination;\n  this.waypoints = options.waypoints;\n\n  this.map = options.map;\n  this.route = options.route;\n  this.step_count = 0;\n  this.steps = this.route.legs[0].steps;\n  this.steps_length = this.steps.length;\n\n  this.polyline = this.map.drawPolyline({\n    path: new google.maps.MVCArray(),\n    strokeColor: options.strokeColor,\n    strokeOpacity: options.strokeOpacity,\n    strokeWeight: options.strokeWeight\n  }).getPath();\n};\n\nGMaps.Route.prototype.getRoute = function(options) {\n  var self = this;\n\n  this.map.getRoutes({\n    origin : this.origin,\n    destination : this.destination,\n    travelMode : options.travelMode,\n    waypoints : this.waypoints || [],\n    error: options.error,\n    callback : function() {\n      self.route = e[0];\n\n      if (options.callback) {\n        options.callback.call(self);\n      }\n    }\n  });\n};\n\nGMaps.Route.prototype.back = function() {\n  if (this.step_count > 0) {\n    this.step_count--;\n    var path = this.route.legs[0].steps[this.step_count].path;\n\n    for (var p in path){\n      if (path.hasOwnProperty(p)){\n        this.polyline.pop();\n      }\n    }\n  }\n};\n\nGMaps.Route.prototype.forward = function() {\n  if (this.step_count < this.steps_length) {\n    var path = this.route.legs[0].steps[this.step_count].path;\n\n    for (var p in path){\n      if (path.hasOwnProperty(p)){\n        this.polyline.push(path[p]);\n      }\n    }\n    this.step_count++;\n  }\n};\n\nGMaps.prototype.checkGeofence = function(lat, lng, fence) {\n  return fence.containsLatLng(new google.maps.LatLng(lat, lng));\n};\n\nGMaps.prototype.checkMarkerGeofence = function(marker, outside_callback) {\n  if (marker.fences) {\n    for (var i = 0, fence; fence = marker.fences[i]; i++) {\n      var pos = marker.getPosition();\n      if (!this.checkGeofence(pos.lat(), pos.lng(), fence)) {\n        outside_callback(marker, fence);\n      }\n    }\n  }\n};\n\nGMaps.prototype.toImage = function(options) {\n  var options = options || {},\n      static_map_options = {};\n\n  static_map_options['size'] = options['size'] || [this.el.clientWidth, this.el.clientHeight];\n  static_map_options['lat'] = this.getCenter().lat();\n  static_map_options['lng'] = this.getCenter().lng();\n\n  if (this.markers.length > 0) {\n    static_map_options['markers'] = [];\n    \n    for (var i = 0; i < this.markers.length; i++) {\n      static_map_options['markers'].push({\n        lat: this.markers[i].getPosition().lat(),\n        lng: this.markers[i].getPosition().lng()\n      });\n    }\n  }\n\n  if (this.polylines.length > 0) {\n    var polyline = this.polylines[0];\n    \n    static_map_options['polyline'] = {};\n    static_map_options['polyline']['path'] = google.maps.geometry.encoding.encodePath(polyline.getPath());\n    static_map_options['polyline']['strokeColor'] = polyline.strokeColor\n    static_map_options['polyline']['strokeOpacity'] = polyline.strokeOpacity\n    static_map_options['polyline']['strokeWeight'] = polyline.strokeWeight\n  }\n\n  return GMaps.staticMapURL(static_map_options);\n};\n\nGMaps.staticMapURL = function(options){\n  var parameters = [],\n      data,\n      static_root = 'http://maps.googleapis.com/maps/api/staticmap';\n\n  if (options.url) {\n    static_root = options.url;\n    delete options.url;\n  }\n\n  static_root += '?';\n\n  var markers = options.markers;\n  \n  delete options.markers;\n\n  if (!markers && options.marker) {\n    markers = [options.marker];\n    delete options.marker;\n  }\n\n  var styles = options.styles;\n\n  delete options.styles;\n\n  var polyline = options.polyline;\n  delete options.polyline;\n\n  /** Map options **/\n  if (options.center) {\n    parameters.push('center=' + options.center);\n    delete options.center;\n  }\n  else if (options.address) {\n    parameters.push('center=' + options.address);\n    delete options.address;\n  }\n  else if (options.lat) {\n    parameters.push(['center=', options.lat, ',', options.lng].join(''));\n    delete options.lat;\n    delete options.lng;\n  }\n  else if (options.visible) {\n    var visible = encodeURI(options.visible.join('|'));\n    parameters.push('visible=' + visible);\n  }\n\n  var size = options.size;\n  if (size) {\n    if (size.join) {\n      size = size.join('x');\n    }\n    delete options.size;\n  }\n  else {\n    size = '630x300';\n  }\n  parameters.push('size=' + size);\n\n  if (!options.zoom && options.zoom !== false) {\n    options.zoom = 15;\n  }\n\n  var sensor = options.hasOwnProperty('sensor') ? !!options.sensor : true;\n  delete options.sensor;\n  parameters.push('sensor=' + sensor);\n\n  for (var param in options) {\n    if (options.hasOwnProperty(param)) {\n      parameters.push(param + '=' + options[param]);\n    }\n  }\n\n  /** Markers **/\n  if (markers) {\n    var marker, loc;\n\n    for (var i=0; data=markers[i]; i++) {\n      marker = [];\n\n      if (data.size && data.size !== 'normal') {\n        marker.push('size:' + data.size);\n        delete data.size;\n      }\n      else if (data.icon) {\n        marker.push('icon:' + encodeURI(data.icon));\n        delete data.icon;\n      }\n\n      if (data.color) {\n        marker.push('color:' + data.color.replace('#', '0x'));\n        delete data.color;\n      }\n\n      if (data.label) {\n        marker.push('label:' + data.label[0].toUpperCase());\n        delete data.label;\n      }\n\n      loc = (data.address ? data.address : data.lat + ',' + data.lng);\n      delete data.address;\n      delete data.lat;\n      delete data.lng;\n\n      for(var param in data){\n        if (data.hasOwnProperty(param)) {\n          marker.push(param + ':' + data[param]);\n        }\n      }\n\n      if (marker.length || i === 0) {\n        marker.push(loc);\n        marker = marker.join('|');\n        parameters.push('markers=' + encodeURI(marker));\n      }\n      // New marker without styles\n      else {\n        marker = parameters.pop() + encodeURI('|' + loc);\n        parameters.push(marker);\n      }\n    }\n  }\n\n  /** Map Styles **/\n  if (styles) {\n    for (var i = 0; i < styles.length; i++) {\n      var styleRule = [];\n      if (styles[i].featureType){\n        styleRule.push('feature:' + styles[i].featureType.toLowerCase());\n      }\n\n      if (styles[i].elementType) {\n        styleRule.push('element:' + styles[i].elementType.toLowerCase());\n      }\n\n      for (var j = 0; j < styles[i].stylers.length; j++) {\n        for (var p in styles[i].stylers[j]) {\n          var ruleArg = styles[i].stylers[j][p];\n          if (p == 'hue' || p == 'color') {\n            ruleArg = '0x' + ruleArg.substring(1);\n          }\n          styleRule.push(p + ':' + ruleArg);\n        }\n      }\n\n      var rule = styleRule.join('|');\n      if (rule != '') {\n        parameters.push('style=' + rule);\n      }\n    }\n  }\n\n  /** Polylines **/\n  function parseColor(color, opacity) {\n    if (color[0] === '#'){\n      color = color.replace('#', '0x');\n\n      if (opacity) {\n        opacity = parseFloat(opacity);\n        opacity = Math.min(1, Math.max(opacity, 0));\n        if (opacity === 0) {\n          return '0x00000000';\n        }\n        opacity = (opacity * 255).toString(16);\n        if (opacity.length === 1) {\n          opacity += opacity;\n        }\n\n        color = color.slice(0,8) + opacity;\n      }\n    }\n    return color;\n  }\n\n  if (polyline) {\n    data = polyline;\n    polyline = [];\n\n    if (data.strokeWeight) {\n      polyline.push('weight:' + parseInt(data.strokeWeight, 10));\n    }\n\n    if (data.strokeColor) {\n      var color = parseColor(data.strokeColor, data.strokeOpacity);\n      polyline.push('color:' + color);\n    }\n\n    if (data.fillColor) {\n      var fillcolor = parseColor(data.fillColor, data.fillOpacity);\n      polyline.push('fillcolor:' + fillcolor);\n    }\n\n    var path = data.path;\n    if (path.join) {\n      for (var j=0, pos; pos=path[j]; j++) {\n        polyline.push(pos.join(','));\n      }\n    }\n    else {\n      polyline.push('enc:' + path);\n    }\n\n    polyline = polyline.join('|');\n    parameters.push('path=' + encodeURI(polyline));\n  }\n\n  /** Retina support **/\n  var dpi = window.devicePixelRatio || 1;\n  parameters.push('scale=' + dpi);\n\n  parameters = parameters.join('&');\n  return static_root + parameters;\n};\n\nGMaps.prototype.addMapType = function(mapTypeId, options) {\n  if (options.hasOwnProperty(\"getTileUrl\") && typeof(options[\"getTileUrl\"]) == \"function\") {\n    options.tileSize = options.tileSize || new google.maps.Size(256, 256);\n\n    var mapType = new google.maps.ImageMapType(options);\n\n    this.map.mapTypes.set(mapTypeId, mapType);\n  }\n  else {\n    throw \"'getTileUrl' function required.\";\n  }\n};\n\nGMaps.prototype.addOverlayMapType = function(options) {\n  if (options.hasOwnProperty(\"getTile\") && typeof(options[\"getTile\"]) == \"function\") {\n    var overlayMapTypeIndex = options.index;\n\n    delete options.index;\n\n    this.map.overlayMapTypes.insertAt(overlayMapTypeIndex, options);\n  }\n  else {\n    throw \"'getTile' function required.\";\n  }\n};\n\nGMaps.prototype.removeOverlayMapType = function(overlayMapTypeIndex) {\n  this.map.overlayMapTypes.removeAt(overlayMapTypeIndex);\n};\n\nGMaps.prototype.addStyle = function(options) {\n  var styledMapType = new google.maps.StyledMapType(options.styles, { name: options.styledMapName });\n\n  this.map.mapTypes.set(options.mapTypeId, styledMapType);\n};\n\nGMaps.prototype.setStyle = function(mapTypeId) {\n  this.map.setMapTypeId(mapTypeId);\n};\n\nGMaps.prototype.createPanorama = function(streetview_options) {\n  if (!streetview_options.hasOwnProperty('lat') || !streetview_options.hasOwnProperty('lng')) {\n    streetview_options.lat = this.getCenter().lat();\n    streetview_options.lng = this.getCenter().lng();\n  }\n\n  this.panorama = GMaps.createPanorama(streetview_options);\n\n  this.map.setStreetView(this.panorama);\n\n  return this.panorama;\n};\n\nGMaps.createPanorama = function(options) {\n  var el = getElementById(options.el, options.context);\n\n  options.position = new google.maps.LatLng(options.lat, options.lng);\n\n  delete options.el;\n  delete options.context;\n  delete options.lat;\n  delete options.lng;\n\n  var streetview_events = ['closeclick', 'links_changed', 'pano_changed', 'position_changed', 'pov_changed', 'resize', 'visible_changed'],\n      streetview_options = extend_object({visible : true}, options);\n\n  for (var i = 0; i < streetview_events.length; i++) {\n    delete streetview_options[streetview_events[i]];\n  }\n\n  var panorama = new google.maps.StreetViewPanorama(el, streetview_options);\n\n  for (var i = 0; i < streetview_events.length; i++) {\n    (function(object, name) {\n      if (options[name]) {\n        google.maps.event.addListener(object, name, function(){\n          options[name].apply(this);\n        });\n      }\n    })(panorama, streetview_events[i]);\n  }\n\n  return panorama;\n};\n\nGMaps.prototype.on = function(event_name, handler) {\n  return GMaps.on(event_name, this, handler);\n};\n\nGMaps.prototype.off = function(event_name) {\n  GMaps.off(event_name, this);\n};\n\nGMaps.custom_events = ['marker_added', 'marker_removed', 'polyline_added', 'polyline_removed', 'polygon_added', 'polygon_removed', 'geolocated', 'geolocation_failed'];\n\nGMaps.on = function(event_name, object, handler) {\n  if (GMaps.custom_events.indexOf(event_name) == -1) {\n    if(object instanceof GMaps) object = object.map; \n    return google.maps.event.addListener(object, event_name, handler);\n  }\n  else {\n    var registered_event = {\n      handler : handler,\n      eventName : event_name\n    };\n\n    object.registered_events[event_name] = object.registered_events[event_name] || [];\n    object.registered_events[event_name].push(registered_event);\n\n    return registered_event;\n  }\n};\n\nGMaps.off = function(event_name, object) {\n  if (GMaps.custom_events.indexOf(event_name) == -1) {\n    if(object instanceof GMaps) object = object.map; \n    google.maps.event.clearListeners(object, event_name);\n  }\n  else {\n    object.registered_events[event_name] = [];\n  }\n};\n\nGMaps.fire = function(event_name, object, scope) {\n  if (GMaps.custom_events.indexOf(event_name) == -1) {\n    google.maps.event.trigger(object, event_name, Array.prototype.slice.apply(arguments).slice(2));\n  }\n  else {\n    if(event_name in scope.registered_events) {\n      var firing_events = scope.registered_events[event_name];\n\n      for(var i = 0; i < firing_events.length; i++) {\n        (function(handler, scope, object) {\n          handler.apply(scope, [object]);\n        })(firing_events[i]['handler'], scope, object);\n      }\n    }\n  }\n};\n\nGMaps.geolocate = function(options) {\n  var complete_callback = options.always || options.complete;\n\n  if (navigator.geolocation) {\n    navigator.geolocation.getCurrentPosition(function(position) {\n      options.success(position);\n\n      if (complete_callback) {\n        complete_callback();\n      }\n    }, function(error) {\n      options.error(error);\n\n      if (complete_callback) {\n        complete_callback();\n      }\n    }, options.options);\n  }\n  else {\n    options.not_supported();\n\n    if (complete_callback) {\n      complete_callback();\n    }\n  }\n};\n\nGMaps.geocode = function(options) {\n  this.geocoder = new google.maps.Geocoder();\n  var callback = options.callback;\n  if (options.hasOwnProperty('lat') && options.hasOwnProperty('lng')) {\n    options.latLng = new google.maps.LatLng(options.lat, options.lng);\n  }\n\n  delete options.lat;\n  delete options.lng;\n  delete options.callback;\n  \n  this.geocoder.geocode(options, function(results, status) {\n    callback(results, status);\n  });\n};\n\n//==========================\n// Polygon containsLatLng\n// https://github.com/tparkin/Google-Maps-Point-in-Polygon\n// Poygon getBounds extension - google-maps-extensions\n// http://code.google.com/p/google-maps-extensions/source/browse/google.maps.Polygon.getBounds.js\nif (!google.maps.Polygon.prototype.getBounds) {\n  google.maps.Polygon.prototype.getBounds = function(latLng) {\n    var bounds = new google.maps.LatLngBounds();\n    var paths = this.getPaths();\n    var path;\n\n    for (var p = 0; p < paths.getLength(); p++) {\n      path = paths.getAt(p);\n      for (var i = 0; i < path.getLength(); i++) {\n        bounds.extend(path.getAt(i));\n      }\n    }\n\n    return bounds;\n  };\n}\n\nif (!google.maps.Polygon.prototype.containsLatLng) {\n  // Polygon containsLatLng - method to determine if a latLng is within a polygon\n  google.maps.Polygon.prototype.containsLatLng = function(latLng) {\n    // Exclude points outside of bounds as there is no way they are in the poly\n    var bounds = this.getBounds();\n\n    if (bounds !== null && !bounds.contains(latLng)) {\n      return false;\n    }\n\n    // Raycast point in polygon method\n    var inPoly = false;\n\n    var numPaths = this.getPaths().getLength();\n    for (var p = 0; p < numPaths; p++) {\n      var path = this.getPaths().getAt(p);\n      var numPoints = path.getLength();\n      var j = numPoints - 1;\n\n      for (var i = 0; i < numPoints; i++) {\n        var vertex1 = path.getAt(i);\n        var vertex2 = path.getAt(j);\n\n        if (vertex1.lng() < latLng.lng() && vertex2.lng() >= latLng.lng() || vertex2.lng() < latLng.lng() && vertex1.lng() >= latLng.lng()) {\n          if (vertex1.lat() + (latLng.lng() - vertex1.lng()) / (vertex2.lng() - vertex1.lng()) * (vertex2.lat() - vertex1.lat()) < latLng.lat()) {\n            inPoly = !inPoly;\n          }\n        }\n\n        j = i;\n      }\n    }\n\n    return inPoly;\n  };\n}\n\nif (!google.maps.Circle.prototype.containsLatLng) {\n  google.maps.Circle.prototype.containsLatLng = function(latLng) {\n    if (google.maps.geometry) {\n      return google.maps.geometry.spherical.computeDistanceBetween(this.getCenter(), latLng) <= this.getRadius();\n    }\n    else {\n      return true;\n    }\n  };\n}\n\ngoogle.maps.LatLngBounds.prototype.containsLatLng = function(latLng) {\n  return this.contains(latLng);\n};\n\ngoogle.maps.Marker.prototype.setFences = function(fences) {\n  this.fences = fences;\n};\n\ngoogle.maps.Marker.prototype.addFence = function(fence) {\n  this.fences.push(fence);\n};\n\ngoogle.maps.Marker.prototype.getId = function() {\n  return this['__gm_id'];\n};\n\n//==========================\n// Array indexOf\n// https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf\nif (!Array.prototype.indexOf) {\n  Array.prototype.indexOf = function (searchElement /*, fromIndex */ ) {\n      \"use strict\";\n      if (this == null) {\n          throw new TypeError();\n      }\n      var t = Object(this);\n      var len = t.length >>> 0;\n      if (len === 0) {\n          return -1;\n      }\n      var n = 0;\n      if (arguments.length > 1) {\n          n = Number(arguments[1]);\n          if (n != n) { // shortcut for verifying if it's NaN\n              n = 0;\n          } else if (n != 0 && n != Infinity && n != -Infinity) {\n              n = (n > 0 || -1) * Math.floor(Math.abs(n));\n          }\n      }\n      if (n >= len) {\n          return -1;\n      }\n      var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);\n      for (; k < len; k++) {\n          if (k in t && t[k] === searchElement) {\n              return k;\n          }\n      }\n      return -1;\n  }\n}\n  \nreturn GMaps;\n}));\n"]}